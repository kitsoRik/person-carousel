$main-card-initial: (
    'height': 730px,
    'width': 340px
);

$second-card-initial: (
    'height': 500px,
    'width': 240px,
    'offset': 115px
);

$third-card-initial: (
    'height': 350px,
    'width': 120px,
    'offset': 230px
);

$fourth-card-initial: (
    'height': 260px,
    'width': 90px,
    'offset': 340px
);

$small-coef: 1;

@function getMainCard($small-coef) {
    @return (
        'height': map-get($main-card-initial, 'height') * $small-coef,
        'width': map-get($main-card-initial, 'width') * $small-coef
    );
}

@function getSecondCard($small-coef) {
    @return (
        'height': map-get($second-card-initial, 'height') * $small-coef,
        'width': map-get($second-card-initial, 'width') * $small-coef,
        'offset': map-get($second-card-initial, 'offset') * $small-coef
    );
}

@function getSecondCard($small-coef) {
    @return (
        'height': map-get($second-card-initial, 'height') * $small-coef,
        'width': map-get($second-card-initial, 'width') * $small-coef,
        'offset': map-get($second-card-initial, 'offset') * $small-coef
    );
}

@function getThirdCard($small-coef) {
    @return (
        'height': map-get($third-card-initial, 'height') * $small-coef,
        'width': map-get($third-card-initial, 'width') * $small-coef,
        'offset': map-get($third-card-initial, 'offset') * $small-coef
    );
}

@function getFourthCard($small-coef) {
    @return (
        'height': map-get($fourth-card-initial, 'height') * $small-coef,
        'width': map-get($fourth-card-initial, 'width') * $small-coef,
        'offset': map-get($fourth-card-initial, 'offset') * $small-coef
    );
}

$cover-card-gradient: (
    'from': #1b1c25,
    '29': #282937,
    'to': #505166
);

$transition-time: 300ms;

@mixin card-factory($index, $small-coef) {
    $main-card-width: map-get(getMainCard($small-coef), 'width');

    transition: all $transition-time ease;
    transition-property: height, width, left, top, transform, z-index, filter;

    &::before {
        content: '';
        width: 100%;
        height: 220px;
        background: linear-gradient(0deg, rgba(0, 0, 0, 0) 0, rgba(0, 0, 0, 0.6) 100%);
        position: absolute;
        bottom: 0;
        right: 0;

        filter: blur(4px);

        transition: all $transition-time ease;
    }

    &::after {
        content:'';
        position:absolute;
        left:0; top:0;
        width:100%; height:100%;
        display:inline-block;
        background-image: linear-gradient(90deg, #1b1c25cc 0%,#505166cc 100%);

        opacity: 1;

        z-index: 10000;

        transition: opacity $transition-time ease;
    }

    @if $index <= 0 or $index >= 8 {
        height: 0;
        width: 0;

        $multiply-coef: if($index >= 8, 1, -1);

        top: calc(50%);
        @if $index <= 0 { 
            left: calc(50% - (#{$main-card-width} / 2) - 430px);

            transform: perspective(100px)  rotateY(-1deg);
        } @else {    
            left: calc(50% + (#{$main-card-width} / 2) + 430px);
    
            transform: perspective(100px) rotateY(0);
        }

        filter: blur(7px);
        
        z-index: 1;
        

        &::before {
            height: 0;
            transform: perspective(50px) rotateX(1deg) rotateY(0) translate($multiply-coef * 0px, 0px) skewX($multiply-coef * 45deg);
        }
    } @else {
        @if $index == 1 or $index == 7 { 
            $height: map-get(getFourthCard($small-coef), $key: 'height');
            $width: map-get(getFourthCard($small-coef), $key: 'width');
            $offset: map-get(getFourthCard($small-coef), $key: 'offset');

            $multiply-coef: if($index == 7, 1, -1);

            height: $height;
            width: $width;

            top: calc(50% - #{$height / 2});
    
            @if($index == 1) {         
                left: calc(50% - (#{$main-card-width} / 2) - #{$offset + 20px});
        
                transform: perspective(12px) rotateY(-1deg);
            }
            @else {
                left: calc(50% + (#{$main-card-width} / 2) + #{$offset - $width + 30px});
        
                transform: perspective(12px) rotateY(1deg);
            }

            filter: blur(5px);

            z-index: 2;

            &::before {
                height: 155px;
                transform: perspective(50px) rotateX(1deg) rotateY(0) translate($multiply-coef * 93px, 167px) skewX($multiply-coef * 52deg);
            }
        }

        @if $index == 2 or $index == 6 {  
            $height: map-get(getThirdCard($small-coef), $key: 'height');
            $width: map-get(getThirdCard($small-coef), $key: 'width');
            $offset: map-get(getThirdCard($small-coef), $key: 'offset');

            height: $height;
            width: $width;

            $multiply-coef: if($index == 6, 1, -1);

            top: calc(50% - #{$height / 2});

            @if($index == 2) {         
                left: calc(50% - (#{$main-card-width} / 2) - #{$offset + 20px});

                transform: perspective(15px)  rotateY(-1deg);
            }
            @else {
                left: calc(50% + (#{$main-card-width} / 2) + #{$offset - $width + 30px});
        
                transform: perspective(15px) rotateY(1deg);
            }

            filter: blur(4px);
                
            z-index: 3;

            &::before {
                content: '';
                transform: perspective(220px) rotateX(1deg) rotateY(0) translate($multiply-coef * 116px, 249px) skewX($multiply-coef * 45deg);
            }
        }

        @if $index == 3 or $index == 5 {   
            $height: map-get(getSecondCard($small-coef), $key: 'height');
            $width: map-get(getSecondCard($small-coef), $key: 'width');
            $offset: map-get(getSecondCard($small-coef), $key: 'offset');

            height: $height;
            width: $width;

            $multiply-coef: if($index == 5, 1, -1);

            top: calc(50% - #{$height / 2});

            @if($index == 3) {
                left: calc(50% - (#{$main-card-width} / 2) - #{$offset});
            }
            @else {
                left: calc(50% + (#{$main-card-width} / 2) - #{$offset});
            }
            
            transform: perspective(25px) rotateY(#{-4 + $index + deg});

            filter: blur(3px);
            
            z-index: 4;

            &::before {
                content: '';
                height: 154px;
                width: 60%;

                @if($index == 3) {
                    transform: perspective(13px) rotateX(1deg) rotateY(0) translate(calc(-94px - 40%), 162px) skewX(-45deg);
                }
                @else {
                    transform: perspective(13px) rotateX(1deg) rotateY(0) translate(94px, 162px) skewX(45deg);
                }
            }
        }

        @if $index == 4 {
            $height: map-get($map: getMainCard($small-coef), $key: 'height');

            height: $height;
            width: $main-card-width;


            top: calc(50% - #{$height / 2});
            left: calc(50% - (#{$main-card-width} / 2));
    
            transform: perspective(0)  rotateY(0);

            z-index: 5;
            filter: blur(0);

            &::before {
                width: 250px;
                transform: perspective(6px) rotateX(1deg) translate(-30px, 210px) skewX(0deg);
            }

            &::after {
                opacity: 0;
            }
        }

    }
}

@mixin useSizeWithCoef($coef) {
    &[attr-type=left-outer] { @include card-factory(0, $coef); }
    &[attr-type=left-fourth] { @include card-factory(1, $coef); }
    &[attr-type=left-third] { @include card-factory(2, $coef); }
    &[attr-type=left-second] { @include card-factory(3, $coef); }
    &[attr-type=main] { @include card-factory(4, $coef); }
    &[attr-type=right-second] { @include card-factory(5, $coef); }
    &[attr-type=right-third] { @include card-factory(6, $coef); }
    &[attr-type=right-fourth] { @include card-factory(7, $coef); }
    &[attr-type=right-outer] { @include card-factory(8, $coef); }
}

@mixin useSize($maxWidthScreen, $coef) {
    @media screen and (max-width: #{$maxWidthScreen + px}) {
        @include useSizeWithCoef($coef);
    }
}

.card {

    position: absolute;

    @include useSizeWithCoef(1);
    @include useSize(1366, 0.7);
    @include useSize(1024, 0.67);
    @include useSize(768, 0.68);
    @include useSize(500, 0.42);
    @include useSize(372, 0.42);
    

    display: flex;
    justify-content: center;

    user-select: none;
}

.cardImage {
    width: 100%;
    height: 100%;

    position: absolute;

    top: 0;
    left: 0;
}